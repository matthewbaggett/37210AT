<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title></title>
    <link href="../css/new.css" rel="stylesheet" type="text/css" />
    <link href="../css/news.css" rel="stylesheet" type="text/css" />
    <link href="../css/ceshi.css" rel="stylesheet" type="text/css" />
    <style type="text/css">
        body
        {
            margin-left: 0px;
            margin-right: 0px;
            margin-top: 0px;
        }
    </style>

    <script language="javascript" src="../js/public.js"></script>
    <script language="javascript" src="../js/jquery-1.8.3.js" ></script>

    <script>
        document.write('<script src="/cgi-bin/get_motion_schedule.cgi"><\/script>');
        document.write('<script src="/cgi-bin/get_dev_funclist.cgi?user=' + top.user + '&pwd=' + top.pwd + '"><\/script>');
        document.write('<script src="/cgi-bin/get_params.cgi?type=16&user=' + top.user + '&pwd=' + top.pwd + '"><\/script>');
    </script>


</head>

<script>
    var first_update = 1;

    //�ճ̰���
    function schedule_onclick() {
        if (document.getElementById("chk_enable_schedule").checked == true) {
            document.getElementById("tr_schedule").style.display = '';
        }
        else {
            document.getElementById("tr_schedule").style.display = 'none';
        }
    }

    function parse_schedule_val(val, day, num) {
        id = 'schedule_' + day;
        num *= 32;
        for (i = 0; i < 32; i++) {
            h = Math.floor(num / 4);
            q = num % 4;
            obj = document.getElementById(id + '_' + h + '_' + q);
            obj.style.backgroundColor = ((val >> i) & 1) ? '#4B6EB6' : '';
            num++;
        }
    }
    //�ճ̰���
    function make_schedule_val(day, num) {
        if (document.getElementById("chk_enable_schedule").checked == false) {
            return 0;
        }

        id = 'schedule_' + day;
        num *= 32;
        val = 0;
        for (i = 0; i < 32; i++) {
            h = Math.floor(num / 4);
            q = num % 4;
            obj = document.getElementById(id + '_' + h + '_' + q);
            val |= (obj.style.backgroundColor != '') ? (1 << i) : 0;
            num++;
        }
        return val;
    }
    //�ճ̰���
    function set_schedule_enable(v) {
        document.getElementById("chk_enable_schedule").checked = v ? true : false;
    }


    function body_onload() {
        if (!video.IsInitialized() == 1) {
            alert(str_onload);
            return false;
        }   
        setTimeout("lazy_load()", 500);
    }

    function lazy_load() {

        if (sd_support == 0) {
            document.getElementById("sd_videot").style.display = 'none';
        }

        if (cloud_support == 0) {
            document.getElementById("option_motion_cloud").style.display = 'none';
        }

        //��ȡ����
        //        document.getElementById("chk_motion_cloud").value = motion_Enable ? true : false;
        document.getElementById("select_motion_enable").value = motion_Enable;
        
        document.getElementById("select_motion_senstiv").value = byMotionSensitive;
        if (mftp_enable == 0) {
            document.getElementById("chk_motion_ftp").checked = false;
            document.getElementById("chk_motion_video_ftp").checked = false;
        } else if (mftp_enable == 1) {
            document.getElementById("chk_motion_ftp").checked = true;
            document.getElementById("chk_motion_video_ftp").checked = false;
        } else if (mftp_enable == 2) {
            document.getElementById("chk_motion_ftp").checked = false;
            document.getElementById("chk_motion_video_ftp").checked = true;
        } else {
            document.getElementById("chk_motion_ftp").checked = true;
            document.getElementById("chk_motion_video_ftp").checked = true;
        }


        setTimeout(function () {
            document.getElementById("select_motion_timeout").value = video.MotionTimeout;
        }, 1000)

        //document.getElementById("select_motion_timeout").value = mtimeout;
        document.getElementById("chk_motion_sdrec").checked = msdrec_enable ? true : false;
        document.getElementById("chk_motion_smtp").checked = mmail_enable ? true : false;

        //senstiv_range_value
        if (byMotionSensitive == 1) {
            document.getElementById("senstiv_range").value = motion_trigger_0;
        } else if (byMotionSensitive == 2) {
            document.getElementById("senstiv_range").value = motion_trigger_1;
        } else if (byMotionSensitive == 3) {
            document.getElementById("senstiv_range").value = motion_trigger_2;
        } else if (byMotionSensitive == 4) {
            document.getElementById("senstiv_range").value = motion_trigger_3;
        } else if (byMotionSensitive == 5) {
            document.getElementById("senstiv_range").value = motion_trigger_4;
        }

        //        timer_connect_camera();

        //enable schedule
        set_schedule_enable(motion_schedule_enable);
        schedule_onclick();
        MotionEnableChange(motion_Enable);




        //parse schedule
        parse_schedule_val(motion_schedule_sun_0, 0, 0);
        parse_schedule_val(motion_schedule_sun_1, 0, 1);
        parse_schedule_val(motion_schedule_sun_2, 0, 2);
        parse_schedule_val(motion_schedule_mon_0, 1, 0);
        parse_schedule_val(motion_schedule_mon_1, 1, 1);
        parse_schedule_val(motion_schedule_mon_2, 1, 2);
        parse_schedule_val(motion_schedule_tue_0, 2, 0);
        parse_schedule_val(motion_schedule_tue_1, 2, 1);
        parse_schedule_val(motion_schedule_tue_2, 2, 2);
        parse_schedule_val(motion_schedule_wed_0, 3, 0);
        parse_schedule_val(motion_schedule_wed_1, 3, 1);
        parse_schedule_val(motion_schedule_wed_2, 3, 2);
        parse_schedule_val(motion_schedule_thu_0, 4, 0);
        parse_schedule_val(motion_schedule_thu_1, 4, 1);
        parse_schedule_val(motion_schedule_thu_2, 4, 2);
        parse_schedule_val(motion_schedule_fri_0, 5, 0);
        parse_schedule_val(motion_schedule_fri_1, 5, 1);
        parse_schedule_val(motion_schedule_fri_2, 5, 2);
        parse_schedule_val(motion_schedule_sat_0, 6, 0);
        parse_schedule_val(motion_schedule_sat_1, 6, 1);
        parse_schedule_val(motion_schedule_sat_2, 6, 2);


    }

    

//    //�ƶ����
    function MotionEnableChange(v) {
        if (v == 0) {
            document.getElementById("select_motion_senstiv").disabled = true;
            document.getElementById("select_motion_timeout").disabled = true;
            document.getElementById('senstiv_range').disabled = true;
        }
        else {
            document.getElementById("select_motion_senstiv").disabled = false;
            document.getElementById("select_motion_timeout").disabled = false;
            document.getElementById('senstiv_range').disabled = false;
        }
        var MotionEnable;
        MotionEnable = document.getElementById("select_motion_enable").value;
        video.MotionEnable = MotionEnable;
    }

    //������
        //���õ�ǰ�����ƶ�����������
    function MotionIndexChange(v) {
        video.SetMotionCurIndex(v);
    }
        //����Ϊȫ����Χ���
    function MotionAll() {
        video.SetAllMotion();
    }
        //ȡ��ȫ����Χ���
//    function DisMotion() {
//        video.SetAllDisMotion();
//    }

    //����
    function UpdateMotion1() {
        //document.getElementById("frame_update_schedule").src="get_schedule.htm";
        window.frame_update_schedule.location = "get_schedule.htm";
    }

    //���ϴ�
    function UpdateMotion2(bCloud) {
        first_update = 0;
        if (bCloud == 0) {
            document.getElementById("chk_motion_cloud").checked = false;
        }
        else {
            document.getElementById("chk_motion_cloud").checked = true;
        }
        //        UpdateMotion();
                location.reload(false);
//        $("#adminmotion", parent.document).click();
    }

//    function UpdateMotion() {
//        var iret;
//        iret = video.AcceptMotionData();

//        if (iret == 0) {
//              alert("AcceptMotionData ok");
//        }
//        else if (iret == 1) {
//            alert(top.str_usalerr_noobj);
//        }
//        else if (iret == 2) {
//            alert(top.str_login_fail);
//        }
//        else if (iret == 3) {
//            alert(top.str_send_acceptmotion_fail);
//        }

//    }

    //�����ƴ������
    function set_motion_extra_params() {
        var tmp_cloud_enable = 0;
        if (document.getElementById("chk_motion_cloud").checked == true) {
            tmp_cloud_enable = 1;
                }
        var tmp_senstiv_range = document.getElementById("senstiv_range").value;
        var tmp_motion_senstiv = document.getElementById("select_motion_senstiv").value;

        if (tmp_motion_senstiv == 1) {
            if (tmp_senstiv_range > 300 || tmp_senstiv_range < 105 || isNaN(tmp_senstiv_range)) {
                alert("105~300");
                return false;
            }
            url = "/cgi-bin/set_motion_extra_params.cgi?mcloud_enable=" + tmp_cloud_enable + "&motion_trigger_0=" + tmp_senstiv_range + "&user=" + top.user + "&pwd=" + top.pwd;
            url += "&motion_trigger_1=" + motion_trigger_1 + "&motion_trigger_2=" + motion_trigger_2 + "&motion_trigger_3=" + motion_trigger_3 + "&motion_trigger_4=" + motion_trigger_4;

        } else if (tmp_motion_senstiv == 2) {
            if (tmp_senstiv_range > 105 || tmp_senstiv_range < 75 || isNaN(tmp_senstiv_range)) {
                alert("75~105");
                return false;
            }
            url = "/cgi-bin/set_motion_extra_params.cgi?mcloud_enable=" + tmp_cloud_enable + "&motion_trigger_1=" + tmp_senstiv_range + "&user=" + top.user + "&pwd=" + top.pwd;
            url += "&motion_trigger_0=" + motion_trigger_0 + "&motion_trigger_2=" + motion_trigger_2 + "&motion_trigger_3=" + motion_trigger_3 + "&motion_trigger_4=" + motion_trigger_4;

        } else if (tmp_motion_senstiv == 3) {
            if (tmp_senstiv_range > 75 || tmp_senstiv_range < 45 || isNaN(tmp_senstiv_range)) {
                alert("45~75");
                return false;
            }
            url = "/cgi-bin/set_motion_extra_params.cgi?mcloud_enable=" + tmp_cloud_enable + "&motion_trigger_2=" + tmp_senstiv_range + "&user=" + top.user + "&pwd=" + top.pwd;
            url += "&motion_trigger_1=" + motion_trigger_1 + "&motion_trigger_0=" + motion_trigger_0 + "&motion_trigger_3=" + motion_trigger_3 + "&motion_trigger_4=" + motion_trigger_4;

        } else if (tmp_motion_senstiv == 4) {
            if (tmp_senstiv_range > 45 || tmp_senstiv_range < 20 || isNaN(tmp_senstiv_range)) {
                alert("20~45");
                return false;
            }
            url = "/cgi-bin/set_motion_extra_params.cgi?mcloud_enable=" + tmp_cloud_enable + "&motion_trigger_3=" + tmp_senstiv_range + "&user=" + top.user + "&pwd=" + top.pwd;
            url += "&motion_trigger_1=" + motion_trigger_1 + "&motion_trigger_2=" + motion_trigger_2 + "&motion_trigger_0=" + motion_trigger_0 + "&motion_trigger_4=" + motion_trigger_4;

        } else if (tmp_motion_senstiv == 5) {
            if (tmp_senstiv_range > 20 || tmp_senstiv_range < 0 || isNaN(tmp_senstiv_range)) {
                alert("0~20");
                return false;
            }
            url = "/cgi-bin/set_motion_extra_params.cgi?mcloud_enable=" + tmp_cloud_enable + "&motion_trigger_4=" + tmp_senstiv_range + "&user=" + top.user + "&pwd=" + top.pwd;
            url += "&motion_trigger_1=" + motion_trigger_1 + "&motion_trigger_2=" + motion_trigger_2 + "&motion_trigger_3=" + motion_trigger_3 + "&motion_trigger_0=" + motion_trigger_0;

        }
        //        url = "/cgi-bin/set_motion_extra_params.cgi?mcloud_enable=" + tmp_cloud_enable + "&user=" + top.user + "&pwd=" + top.pwd;

        schedule_frame.location = url;
    }
    //����
    function SaveMotion() {
        try {
            if (typeof (obj) == "undefined") {
                return false;
            } else {
                setTimeout("set_motion_schedule()", 300);       //�����ƶ���Ⲽ�������ճ̰���
                setTimeout("set_motion_extra_params()", 500);       //�����ƴ������
                setTimeout('set_motion_vars()', 800);       //����   
            }
        } catch (e) {
            alert(e.message)
        }     
    }

    function set_motion_vars() {
        var MotionSensitivity,                              //����ȿ���
            MotionTimeout                                  //���ʱ��
                                      
       
        MotionSensitivity = document.getElementById("select_motion_senstiv").value;
        var ss = document.getElementById("select_motion_timeout").value;

        video.MotionSensitivity = MotionSensitivity;
        video.MotionTimeout = ss;
        
        video.MotionOuterAlarm = 0;                                                     //�������
        if (document.getElementById("chk_motion_outer").checked == true) {          
            video.MotionOuterAlarm = 1;
        }

        video.MotionSDRec = 0;                                                          //SD��¼��
        if (document.getElementById("chk_motion_sdrec").checked == true) {
            video.MotionSDRec = 1;
        }

        video.MotionSmtp = 0;                                                           //����E-mail
        if (document.getElementById("chk_motion_smtp").checked == true) {
            video.MotionSmtp = 1;
        }

        video.MotionFtp = 0;
        if ((document.getElementById("chk_motion_ftp").checked == false) && (document.getElementById("chk_motion_video_ftp").checked == false)) {
            video.MotionFtp = 0;
        } else if ((document.getElementById("chk_motion_ftp").checked == true) && (document.getElementById("chk_motion_video_ftp").checked == false)) {
            video.MotionFtp = 1;
        } else if ((document.getElementById("chk_motion_ftp").checked == false) && (document.getElementById("chk_motion_video_ftp").checked == true)) {
            video.MotionFtp = 2;
        } else if ((document.getElementById("chk_motion_ftp").checked == true) && (document.getElementById("chk_motion_video_ftp").checked == true)) {
            video.MotionFtp = 3;
        }

//        alert(MotionEnable + " : " + video.MotionEnable);
//        alert(MotionSensitivity + ": " + video.MotionSensitivity);
//        alert(MotionTimeout + " : " + video.MotionTimeout);
//        alert('waibubaojin'+ ":" + video.MotionOuterAlarm);
//        alert('SDkaluxiang' + ":" + video.MotionSDRec);
//        alert('fasongE��mail' + ":" + video.MotionSmtp);
//        alert('FTPtupianshangchuan' + ":" + video.MotionFtp);

        var iret;
        iret = video.SaveMotionData();
//        alert("iret = " + iret);
        if (iret == 1) {
            alert(top.str_ret_acceptmotion_succ);
//                        location.reload(false);
//            $("#adminmotion", parent.document).click();
        }
//        else if (iret == 1) {
//            alert(top.str_usalerr_noobj);
//        }
//        else if (iret == 2) {
//            alert(top.str_login_fail);
//        }
        else if (iret == 0) {
            alert(top.str_send_savemotion_fail);
        }
    }



    //�����ƶ���Ⲽ�������ճ̰���
    function set_motion_schedule() {
        //schedule----------------//
        var tmp_sche_enable = 0;
        if (document.getElementById("chk_enable_schedule").checked == true) {
            tmp_sche_enable = 1;
        }
        url2 = "/cgi-bin/set_motion_schedule.cgi?schedule_enable=" + tmp_sche_enable + "&user=" + top.user + "&pwd=" + top.pwd;
        url2 += "&schedule_sun_0=" + make_schedule_val(0, 0) + "&schedule_sun_1=" + make_schedule_val(0, 1) + "&schedule_sun_2=" + make_schedule_val(0, 2);
        url2 += "&schedule_mon_0=" + make_schedule_val(1, 0) + "&schedule_mon_1=" + make_schedule_val(1, 1) + "&schedule_mon_2=" + make_schedule_val(1, 2);
        url2 += "&schedule_tue_0=" + make_schedule_val(2, 0) + "&schedule_tue_1=" + make_schedule_val(2, 1) + "&schedule_tue_2=" + make_schedule_val(2, 2);
        url2 += "&schedule_wed_0=" + make_schedule_val(3, 0) + "&schedule_wed_1=" + make_schedule_val(3, 1) + "&schedule_wed_2=" + make_schedule_val(3, 2);
        url2 += "&schedule_thu_0=" + make_schedule_val(4, 0) + "&schedule_thu_1=" + make_schedule_val(4, 1) + "&schedule_thu_2=" + make_schedule_val(4, 2);
        url2 += "&schedule_fri_0=" + make_schedule_val(5, 0) + "&schedule_fri_1=" + make_schedule_val(5, 1) + "&schedule_fri_2=" + make_schedule_val(5, 2);
        url2 += "&schedule_sat_0=" + make_schedule_val(6, 0) + "&schedule_sat_1=" + make_schedule_val(6, 1) + "&schedule_sat_2=" + make_schedule_val(6, 2);
        //document.getElementById("schedule_frame").location = url2;
        schedule_frame.location = url2;
    }
    //�����ƴ洢���� ����Ȳ���
    function sensitivity(value) {
        if (value == 1) {
            document.getElementById('senstiv_range').value = motion_trigger_0;
        } else if (value == 2) {
            document.getElementById('senstiv_range').value = motion_trigger_1;
        } else if (value == 3) {
            document.getElementById('senstiv_range').value = motion_trigger_2;
        } else if (value == 4) {
            document.getElementById('senstiv_range').value = motion_trigger_3;
        } else if (value == 5) {
            document.getElementById('senstiv_range').value = motion_trigger_4;
        }
    }
    //�����Ĭ��ֵ
    function default_value() {
        var tmp_motion_senstiv = document.getElementById("select_motion_senstiv").value;
        if (tmp_motion_senstiv == 1) {
            document.getElementById("senstiv_range").value = 120;
        } else if (tmp_motion_senstiv == 2) {
            document.getElementById("senstiv_range").value = 90;
        } else if (tmp_motion_senstiv == 3) {
            document.getElementById("senstiv_range").value = 60;
        } else if (tmp_motion_senstiv == 4) {
            document.getElementById("senstiv_range").value = 30;
        } else if (tmp_motion_senstiv == 5) {
            document.getElementById("senstiv_range").value = 10;
        }
    }
    
    function senstiv_range_value() {
        var tmp_motion_senstiv = document.getElementById("select_motion_senstiv").value;
        var tmp_senstiv_range = document.getElementById("senstiv_range").value;
        if (tmp_motion_senstiv == 1) {
            document.getElementById("senstiv_range").setAttribute("placeholder", "105~300");
            if (tmp_senstiv_range > 300 || tmp_senstiv_range < 105 || isNaN(tmp_senstiv_range)) {
                alert("105~300");
            }
        } else if (tmp_motion_senstiv == 2) {
            document.getElementById("senstiv_range").setAttribute("placeholder", "75~105");
            if (tmp_senstiv_range > 105 || tmp_senstiv_range < 75 || isNaN(tmp_senstiv_range)) {
                alert("75~105");
            }
        } else if (tmp_motion_senstiv == 3) {
            document.getElementById("senstiv_range").setAttribute("placeholder", "45~75");
            if (tmp_senstiv_range > 75 || tmp_senstiv_range < 45 || isNaN(tmp_senstiv_range)) {
                alert("45~75");
            }
        } else if (tmp_motion_senstiv == 4) {
            document.getElementById("senstiv_range").setAttribute("placeholder", "20~45");
            if (tmp_senstiv_range > 45 || tmp_senstiv_range < 20 || isNaN(tmp_senstiv_range)) {
                alert("20~45");
            }
        } else if (tmp_motion_senstiv == 5) {
            document.getElementById("senstiv_range").setAttribute("placeholder", "0~20");
            if (tmp_senstiv_range > 20 || tmp_senstiv_range < 0 || isNaN(tmp_senstiv_range)) {
                alert("0~20");
            }
        }
    }

</script>

<!--<script for="video" event="OnConnectServerResult(result, right)">video_OnConnectServerResult(result, right)</script>-->

<!--<script for="video" event="OnNetworkErrorResult(result)">video_OnNetworkErrorResult(result)</script>-->

<!--<script for="video" event="OnRecvMotionDataResult(result)">video_OnRecvMotionDataResult(result)</script>-->

<!--<script for="video" event="OnSendMotionDataResult(result)">video_OnSendMotionDataResult(result)</script>-->

<script language="javascript" event="OnLoad()" for="video">
    function video::OnLoad(){
        video.SetShowMode(3);
        video.ConnectServer(location.hostname, top.video_port, encodeURIComponent(top.user), encodeURIComponent(top.pwd));
        video.StartVideo();
    }
</script>

<body onload="body_onload()" class="body">
<iframe id="frame_update_schedule" name="frame_update_schedule" style="display:none"></iframe>
<iframe id="schedule_frame" name="schedule_frame" style="display:none"></iframe>
    <table width="100%" cellpadding="0" cellspacing="0" style=" text-align:center">
        <tr class="adtop"><td>&nbsp;</td></tr>
        <tr>
            <td align="center">
                <table cellpadding="0" cellspacing="0" >
                   <tr>
                    <td colspan="3" class="mid03_1">
                        <strong class="mid03">
                            <script type="text/javascript">                                document.write(top.str_motion_mt);</script>
                        </strong>
                    </td>
                   </tr>
                  <tr  >
                   <td class="lcorner" ></td>
                   <td class="cbtop">
                     <table cellpadding="0" cellspacing="0" style=" width:730px">
                        <tr style=" width:100%">
                            <td style="text-align: right;" align="right">
                                <button class="resethbutton" onclick="SaveMotion()">
                                    <script>                                        document.write(top.str_save);</script>
                                </button>
                                <button class="resethbutton" onclick="UpdateMotion1()">
                                    <script>                                        document.write(top.str_refresh);</script>
                                </button>    
                             
                            </td>
                      
                        </tr>
                     </table>
                   </td>
                   <td class="rcorner"></td>
                  </tr>
              
                  <tr>
                   <td class="lborder"></td>
                   <td style=" margin-top:0px">
                        <table style="width: 730px; height:100%;"cellpadding="0" cellspacing="0" class="admintr">
                        <tr>
                            <td align="center" style="border-right-color: #ededed">
                                <table border="0" class="admintr">
                                    <tr>
                                        <!--<table border="1" style="width:322px; height:242px; text-align:center" cellpadding="0" cellspacing="0" >-->
                                        <td colspan="2" style="width: 322px; height: 242px; text-align: center; vertical-align: middle">
                                            <div>
                                                <span>
                                                    <object id="video" style="left: 0px; top: 0px" width="321" height="242" classid="clsid:33068ABD-A7FD-46F0-805F-637BE7AD1F49">
                                                    </object>
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="center" style=" background:#C2E5F9;">
                                            <strong class="mid04">

                                                <script>                                                    document.write(top.str_motion_area);</script>

                                            </strong>&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td>
                                            &nbsp;<select id="select_motion_index" onchange="MotionIndexChange(this.value)">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                            </select>&nbsp;&nbsp;&nbsp;
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="center" colspan = "2" >
                                            <button style="width: 98px" class="mid042" onclick="MotionAll()">

                                                <script>                                                    document.write(top.str_all_detect);</script>

                                            </button>
                                        </td>
                                        <!--<td align="center">
                                            <button style="width: 98px" class="mid042" onclick="DisMotion()">

                                                <script>                                                    document.write(top.str_clear_detect);</script>

                                            </button>
                                        </td>-->
                                    </tr>
                                </table>
                            </td>
                            <td width="350px">
                                <table class="admintr"  border="1" id="Admintr">
                                    <tr style="height: 30px">
                                        <td width="150px" style=" background:#C2E5F9;" >
                                            <strong class="mid04">

                                                <script>                                                    document.write(top.str_motion_mt);</script>

                                            </strong>
                                        </td>
                                        <td width="130px">
                                            <select style="width: 95px" id="select_motion_enable" onchange="MotionEnableChange(this.value)">
                                                <option value="0">

                                                    <script>                                                        document.write(top.str_close);</script>

                                                </option>
                                                <option value="1">

                                                    <script>                                                        document.write(top.str_open);</script>

                                                </option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr style="height: 30px">
                                        <td style=" background:#C2E5F9;">
                                            <strong class="mid04">

                                                <script>                                                    document.write(top.str_sensitivity);</script>

                                            </strong>
                                        </td>
                                        <td>
                                            <select style="width: 95px" id="select_motion_senstiv" onchange="sensitivity(this.value)">                                         
                                                <option value="1">

                                                    <script>                                                        document.write(top.str_low);</script>

                                                </option>
                                                <option value="2">

                                                    <script>                                                        document.write(top.str_center);</script>

                                                </option>
                                                <option value="3">

                                                    <script>                                                        document.write(top.str_high);</script>

                                                </option>
                                                <option value="4">

                                                    <script>                                                        document.write(top.str_above_normal);</script>

                                                </option>
                                                <option value="5">

                                                    <script>                                                        document.write(top.str_highest);</script>

                                                </option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr style="height: 30px;" id="tr_sensitivity" >  
                                        <td style=" background:#C2E5F9;">
                                            <strong class="mid04">

                                                <script>                                                    document.write(top.str_sensitivity_range);</script>

                                            </strong><button onclick="default_value()"><script>                                                                                           document.write(top.str_default_value)</script></button>
                                        </td>
                                        <td>
                                            <input id="senstiv_range" type="text" style="width: 95px;" onchange="senstiv_range_value()"/>
                                        </td>
                                    </tr>
                                    <tr style="height: 30px">
                                        <td style=" background:#C2E5F9;">
                                            <strong class="mid04">

                                                <script>                                                    document.write(top.str_Time1);</script>

                                            </strong>
                                        </td>
                                        <td>
                                            <input id="select_motion_timeout" type="text" style="width: 95px" onkeyup="this.value=this.value.replace(/[^0-9]/gi,'')"/> S
                                            <!--<select style="width: 95px" id="select_motion_timeout">
                                               <option value="0">

                                                    <script>                                                        document.write(top.str_all_forever);</script>

                                                </option>
                                                <option value="1">5s</option>
                                                <option value="2">10s</option>
                                                <option value="3">15s</option>
                                                <option value="4">30s</option>
                                                <option value="5">60s</option>
                                           </select>-->
                                        </td>
                                    </tr>
                                    <tr style="height: 30px">
                                        <td style=" background:#C2E5F9;">
                                            <strong class="mid04">

                                                <script>                                                    document.write(top.str_schedule);</script>

                                            </strong>
                                        </td>
                                        <td>
                                            <input type="checkbox" id="chk_enable_schedule" name="chk_enable_schedule" onclick="schedule_onclick()" />
                                        </td>
                                    </tr>
                                    <tr style=" background-color:#A2D7E8" height="30px">
                                        <td colspan="2" align="left">
                                            <strong class="mida04">

                                                <script>                                                    document.write(top.str_action_with_alarm);</script>

                                            </strong>
                                        </td>
                                    </tr>
                                    <tr style="height: 30px; display:none">
                                        <td style=" background:#C2E5F9;">
                                            <strong class="mid04">

                                                <script>                                                    document.write(top.str_output_alarm);</script>

                                            </strong>
                                        </td>
                                        <td>
                                            <input type="checkbox" id="chk_motion_outer" />
                                        </td>
                                    </tr>
                                    <tr style="height: 30px" id ="sd_videot">
                                        <td style=" background:#C2E5F9;">
                                            <strong class="mid04">

                                                <script>                                                    document.write(top.str_sd_videotape);</script>

                                            </strong>&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td>
                                            <input type="checkbox" id="chk_motion_sdrec" />
                                        </td>
                                    </tr>
                                    <tr style="height: 30px">
                                        <td style=" background:#C2E5F9;">
                                            <strong class="mid04">

                                                <script>                                                    document.write(top.str_sent_email);</script>

                                            </strong>
                                        </td>
                                        <td>
                                            <input type="checkbox" id="chk_motion_smtp" />
                                        </td>
                                    </tr>
                                    <tr style="height: 30px">
                                        <td style=" background:#C2E5F9;">
                                            <strong class="mid04">

                                                <script>                                                    document.write(top.str_ftp_uploading);</script>

                                            </strong>
                                        </td>
                                        <td>
                                            <input type="checkbox" id="chk_motion_ftp" />
                                        </td>
                                    </tr>
                                    <tr style="height: 30px">
                                        <td style=" background:#C2E5F9;">
                                            <strong class="mid04">

                                                <script>                                                    document.write(top.str_ftp_video_uploading);</script>

                                            </strong>
                                        </td>
                                        <td>
                                            <input type="checkbox" id="chk_motion_video_ftp" />
                                        </td>
                                    </tr>
                                    <tr style="height: 30px" id="option_motion_cloud">
                                        <td style=" background:#C2E5F9;">
                                            <strong class="mid04">

                                                <script>                                                    document.write(top.str_cloud_upload);</script>

                                            </strong>
                                        </td>
                                        <td>
                                            <input type="checkbox" id="chk_motion_cloud" />
                                        </td>
                                    </tr>
                                    <!--<tr style="height: 30px">
                                        <td>
                                            <strong class="mid04">

                                                <script>document.write(top.str_dropbox_uploading);</script>

                                            </strong>
                                        </td>
                                        <td>
                                            <input type="checkbox" id="chk_motion_dropbox" />
                                        </td>
                                    </tr>-->
                                </table>
                            </td>
                        </tr>
                        <tr id="tr_schedule">
                            <td class="mid05 bc4" colspan="2">
                                <table class="alh2 alv2 ff14" width="100%" style="border-collapse: collapse; border-spacing: 0;"
                                    border="1" align="center">
                                    <tr>

                                        <script>                                            document.write('<td>' + top.str_day + '<\/td>'); for (i = 0; i < 24; i++) document.write('<td width=22 colspan=4>' + i + '<\/td>');</script>

                                    </tr>

                                    <script>
                                        var str_day = new Array();
                                        str_day[0] = top.str_sun;
                                        str_day[1] = top.str_mon;
                                        str_day[2] = top.str_tue;
                                        str_day[3] = top.str_wed;
                                        str_day[4] = top.str_thu;
                                        str_day[5] = top.str_fri;
                                        str_day[6] = top.str_sat;
                                        var first_mouse = 0;
                                        var last_mouse = 0;
                                        function set_schedule(id, dbl,th) {
                                            var id_head = id.substring(0, id.lastIndexOf('_'));
                                            var obj = document.getElementById(id);
                                            if (obj.style.backgroundColor == '') {
                                                if (dbl) {
                                                    for (i = 0; i < 4; i++) {
                                                        var obj = document.getElementById(id_head + '_' + i + '_' + j);
                                                        obj.style.backgroundColor = top.browser ? '#4B6EB6' : '';
                                                    }

                                                }
                                                else
                                                    obj.style.backgroundColor = '#4B6EB6';
                                            }
                                            else {
                                                if (dbl) {
                                                    for (i = 0; i < 4; i++) {
                                                        var obj = document.getElementById(id_head + '_' + i + '_' + j);
                                                        obj.style.backgroundColor = top.browser ? '' : '#4B6EB6';
                                                    }
                                                }
                                                else
                                                    obj.style.backgroundColor = '';
                                            }
                                            first_mouse = th; 
                                        }
                                        function ms_down(th) {
                                            first_mouse = th;
                                        }
                                        function ms_up(th) {
                                            last_mouse = th;
                                            mouse_coordinate(first_mouse, last_mouse);
                                        }


                                        function mouse_coordinate(first, last) {

                                            m = first.getAttribute("sb_index");
                                            n = last.getAttribute("sb_index");

                                            var first_x = 0;
                                            var first_y = 0;
                                            var first_z = 0;
                                            var last_x = 0;
                                            var last_y = 0;
                                            var last_z = 0;


                                            //alert('first_x:'+first_x+',last_x:'+last_x);
                                            //document.querySelector('[id="schedule_2_11_0"]').style.backgroundColor ='#4B6EB6';

                                            if (m < n || m > n) {
                                                var tmp = first.getAttribute("id");
                                                tmp = tmp.split('_');
                                                var tmp2 = last.getAttribute("id");
                                                tmp2 = tmp2.split('_');
                                                if (m < n) {
                                                    first_x = tmp[1];
                                                    first_y = tmp[2];
                                                    first_z = tmp[3];
                                                    last_x = tmp2[1];
                                                    last_y = tmp2[2];
                                                    last_z = tmp2[3];
                                                } else {
                                                    first_x = tmp2[1];
                                                    first_y = tmp2[2];
                                                    first_z = tmp2[3];
                                                    last_x = tmp[1];
                                                    last_y = tmp[2];
                                                    last_z = tmp[3];
                                                }

                                                //alert('first_x:' + first_x + ',last_x:' + last_x);
                                                for (var i = first_x; i <= last_x; i++) {
                                                    for (var k = 0; k < 24; k++) {
                                                        if (k < first_y && i == first_x) {
                                                            continue;
                                                        }
                                                        if (k > last_y && i == last_x) {
                                                            continue;
                                                        }
                                                        for (var j = 0; j < 4; j++) {
                                                            if (j < first_z && i == first_x && k == first_y) {
                                                                continue;
                                                            }
                                                            if (j > last_z && i == last_x && k == last_y) {
                                                                continue;
                                                            }
                                                            var ttt = document.querySelector('[id="schedule_' + i + '_' + k + '_' + j + '"]');
                                                            if (ttt.style.backgroundColor == '' || typeof ttt.style.backgroundColor == 'undefined') {
                                                                ttt.style.backgroundColor = '#4B6EB6';
                                                            } else {
                                                                ttt.style.backgroundColor = '';
                                                            }
                                                        }
                                                    }
                                                }
                                            } else {
                                                var tmp = first.getAttribute("id");
                                                tmp = tmp.split('_');
                                                var tmp2 = last.getAttribute("id");
                                                tmp2 = tmp2.split('_');
                                                first_x = tmp[1];
                                                first_y = tmp[2];
                                                first_z = tmp[3];
                                                last_z = tmp2[3];
                                                for (var j = Math.min(first_z, last_z); j <= Math.max(first_z, last_z); j++) {
                                                    var ttt = document.querySelector('[id="schedule_' + first_x + '_' + first_y + '_' + j + '"]');
                                                    if (ttt.style.backgroundColor == '' || typeof ttt.style.backgroundColor == 'undefined') {
                                                        ttt.style.backgroundColor = '#4B6EB6';
                                                    } else {
                                                        ttt.style.backgroundColor = '';
                                                    }
                                                }
                                            }
                                        }


                                        var sb_index = 1; 
                                        for (i = 0; i < 7; i++) {
                                            document.write('<tr><td class=\"ff12\">' + str_day[i] + '<\/td>');
                                            for (j = 0; j < 24; j++) {
                                                for (m = 0; m < 4; m++) {
                                                    document.write('<td onmousedown=\"ms_down(this)\" onclick=\"set_schedule(id,1)\" ondblclick=\"set_schedule(id,1)\" onmouseup=\"ms_up(this)\" sb_index="' + sb_index + '"  id=\"schedule_' + i + '_' + j + '_' + m + '\"> <\/td>');
                                                } 
                                                sb_index++;
                                            }
                                            document.write('<\/tr>');
                                        } 
                                    </script>

                                </table>
                            </td>
                        </tr>
                        <td colspan="2" align="center"><script>document.write(top.str_Motion_prompt)</script></td>
                    </table>
                   
                   </td>
                   <td  class="rborder"></td>
                  </tr>
              
                  <tr>
                   <td class="ldcorner"></td>
                   <td class="cdow"></td>
                   <td class="rdcorner"></td>
                  </tr>
           
                </table>
            </td>
        </tr>
     </table>
</body>
</html>
